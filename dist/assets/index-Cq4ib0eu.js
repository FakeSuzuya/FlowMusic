import{r as a,a as Ee,u as J,b as Re,L as P,c as Te,B as Ie,R as De,d as I,e as Fe}from"./vendor-C_y_h-Nj.js";import{X as B,I as Be,A as X,a as Oe,C as He,M as te,S as ee,H as Ve,b as _e,L as ce,U as K,B as Ge,c as se,d as Ce,e as Se,f as Je,g as We,h as $,i as Qe,j as O,k as je,l as ve,P as ae,m as H,n as Ne,R as ge,o as fe,p as Y,q as Xe,r as we,V as Ke,s as Ze,t as Ye,u as be,v as oe,w as _,x as re,y as ye,Z as es,D as ss,z as as,E as ts,T as de,F as ne,G as Pe,J as xe,K as ue,N as Ue,O as Me,Q,W as is,Y as rs,_ as ns,$ as ls,a0 as cs,a1 as os,a2 as ds,a3 as us,a4 as ms,a5 as hs,a6 as xs}from"./icons-0mWGD2Lg.js";(function(){const l=document.createElement("link").relList;if(l&&l.supports&&l.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))d(t);new MutationObserver(t=>{for(const m of t)if(m.type==="childList")for(const u of m.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&d(u)}).observe(document,{childList:!0,subtree:!0});function r(t){const m={};return t.integrity&&(m.integrity=t.integrity),t.referrerPolicy&&(m.referrerPolicy=t.referrerPolicy),t.crossOrigin==="use-credentials"?m.credentials="include":t.crossOrigin==="anonymous"?m.credentials="omit":m.credentials="same-origin",m}function d(t){if(t.ep)return;t.ep=!0;const m=r(t);fetch(t.href,m)}})();var $e={exports:{}},ie={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ps=a,js=Symbol.for("react.element"),vs=Symbol.for("react.fragment"),Ns=Object.prototype.hasOwnProperty,gs=ps.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,fs={key:!0,ref:!0,__self:!0,__source:!0};function Ae(s,l,r){var d,t={},m=null,u=null;r!==void 0&&(m=""+r),l.key!==void 0&&(m=""+l.key),l.ref!==void 0&&(u=l.ref);for(d in l)Ns.call(l,d)&&!fs.hasOwnProperty(d)&&(t[d]=l[d]);if(s&&s.defaultProps)for(d in l=s.defaultProps,l)t[d]===void 0&&(t[d]=l[d]);return{$$typeof:js,type:s,key:m,ref:u,props:t,_owner:gs.current}}ie.Fragment=vs;ie.jsx=Ae;ie.jsxs=Ae;$e.exports=ie;var e=$e.exports,me={},ke=Ee;me.createRoot=ke.createRoot,me.hydrateRoot=ke.hydrateRoot;const he=a.createContext(null),le="/api";function bs({children:s}){const[l,r]=a.useState(null),[d,t]=a.useState(!0),[m,u]=a.useState(()=>{try{return localStorage.getItem("token")}catch{return null}}),p=a.useCallback(()=>{try{localStorage.removeItem("token")}catch(x){console.error("Erreur localStorage:",x)}u(null),r(null)},[]),v=a.useCallback(async()=>{if(!m){t(!1);return}try{const x=new AbortController,y=setTimeout(()=>x.abort(),1e4),g=await fetch(`${le}/auth/me`,{headers:{Authorization:`Bearer ${m}`},signal:x.signal});if(clearTimeout(y),g.ok){const o=await g.json();r(o.user)}else p()}catch(x){x.name==="AbortError"?console.warn("Timeout lors de la récupération utilisateur"):console.error("Erreur lors de la récupération utilisateur:",x)}finally{t(!1)}},[m,p]);a.useEffect(()=>{v()},[v]);const N={user:l,token:m,loading:d,login:async(x,y)=>{const g=await fetch(`${le}/auth/login`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:x,password:y})}),o=await g.json();if(!g.ok)throw new Error(o.message||"Erreur de connexion");try{localStorage.setItem("token",o.token)}catch(c){console.error("Erreur localStorage:",c)}return u(o.token),r(o.user),o},register:async(x,y,g)=>{const o=await fetch(`${le}/auth/register`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:x,email:y,password:g})}),c=await o.json();if(!o.ok)throw new Error(c.message||"Erreur d'inscription");try{localStorage.setItem("token",c.token)}catch(j){console.error("Erreur localStorage:",j)}return u(c.token),r(c.user),c},logout:()=>{p()},updateUser:x=>{r(y=>({...y,...x}))},isAuthenticated:!!l};return d?e.jsx(he.Provider,{value:N,children:e.jsx("div",{className:"app-loading",children:e.jsxs("div",{className:"loading-content",children:[e.jsx("div",{className:"spinner"}),e.jsx("p",{children:"Chargement..."})]})})}):e.jsx(he.Provider,{value:N,children:s})}function D(){const s=a.useContext(he);if(!s)throw new Error("useAuth doit être utilisé dans un AuthProvider");return s}const qe=a.createContext(null);function ys({children:s}){const l=a.useRef(new Audio),[r,d]=a.useState(null),[t,m]=a.useState([]),[u,p]=a.useState(!1),[v,k]=a.useState(0),[b,h]=a.useState(0),[n,N]=a.useState(.7),[x,y]=a.useState(!1),[g,o]=a.useState("none");a.useEffect(()=>{const f=l.current,U=()=>k(f.currentTime),q=()=>h(f.duration),L=()=>C();return f.addEventListener("timeupdate",U),f.addEventListener("durationchange",q),f.addEventListener("ended",L),()=>{f.removeEventListener("timeupdate",U),f.removeEventListener("durationchange",q),f.removeEventListener("ended",L)}},[]),a.useEffect(()=>{l.current.volume=n},[n]);const c=(f,U=[])=>{U.length>0&&m(U),d(f),l.current.src=f.audioUrl||`/api/tracks/${f.id}/stream`,l.current.play(),p(!0)},j=()=>{u?l.current.pause():l.current.play(),p(!u)},z=()=>{l.current.pause(),p(!1)},M=f=>{l.current.currentTime=f,k(f)},C=()=>{if(g==="one")l.current.currentTime=0,l.current.play();else if(t.length>0){const f=t.findIndex(q=>q.id===(r==null?void 0:r.id));let U;x?U=Math.floor(Math.random()*t.length):U=f+1,U<t.length?c(t[U]):g==="all"?c(t[0]):p(!1)}else p(!1)},E={currentTrack:r,playlist:t,isPlaying:u,currentTime:v,duration:b,volume:n,shuffle:x,repeat:g,playTrack:c,togglePlay:j,pause:z,seek:M,playNext:()=>{if(t.length===0)return;const f=t.findIndex(q=>q.id===(r==null?void 0:r.id));let U;x?U=Math.floor(Math.random()*t.length):U=(f+1)%t.length,c(t[U])},playPrevious:()=>{if(v>3){M(0);return}if(t.length===0)return;const f=t.findIndex(q=>q.id===(r==null?void 0:r.id)),U=f>0?f-1:t.length-1;c(t[U])},setVolume:N,toggleShuffle:()=>y(!x),toggleRepeat:()=>{const f=["none","all","one"],U=f.indexOf(g);o(f[(U+1)%f.length])},setPlaylist:m};return e.jsx(qe.Provider,{value:E,children:s})}function pe(){const s=a.useContext(qe);if(!s)throw new Error("usePlayer doit être utilisé dans un PlayerProvider");return s}const ks=a.createContext(null);let zs=0;function Cs({children:s}){const[l,r]=a.useState([]),d=a.useCallback((h,n="info",N=4e3)=>{const x=zs++;return r(y=>[...y,{id:x,message:h,type:n}]),N>0&&setTimeout(()=>{t(x)},N),x},[]),t=a.useCallback(h=>{r(n=>n.filter(N=>N.id!==h))},[]),m=a.useCallback((h,n)=>d(h,"success",n),[d]),u=a.useCallback((h,n)=>d(h,"error",n),[d]),p=a.useCallback((h,n)=>d(h,"warning",n),[d]),v=a.useCallback((h,n)=>d(h,"info",n),[d]),k=h=>{switch(h){case"success":return e.jsx(He,{size:22});case"error":return e.jsx(Oe,{size:22});case"warning":return e.jsx(X,{size:22});default:return e.jsx(Be,{size:22})}},b={addToast:d,removeToast:t,success:m,error:u,warning:p,info:v};return e.jsxs(ks.Provider,{value:b,children:[s,e.jsx("div",{className:"toast-container",children:l.map((h,n)=>e.jsxs("div",{className:`toast toast-${h.type}`,style:{animationDelay:`${n*.1}s`},children:[e.jsx("div",{className:"toast-icon",children:k(h.type)}),e.jsx("div",{className:"toast-content",children:e.jsx("p",{className:"toast-message",children:h.message})}),e.jsx("button",{className:"toast-close",onClick:()=>t(h.id),children:e.jsx(B,{size:18})})]},h.id))})]})}function Ss(){var g,o;const{user:s,logout:l,isAuthenticated:r}=D(),d=J(),t=Re(),[m,u]=a.useState(""),[p,v]=a.useState(!1),[k,b]=a.useState(!1),[h,n]=a.useState(!1);a.useEffect(()=>{const c=()=>{n(window.scrollY>20)};return window.addEventListener("scroll",c),()=>window.removeEventListener("scroll",c)},[]),a.useEffect(()=>{v(!1),b(!1)},[t.pathname]);const N=c=>{c.preventDefault(),m.trim()&&(d(`/explore?q=${encodeURIComponent(m)}`),u(""))},x=()=>{l(),d("/"),b(!1)},y=c=>t.pathname===c;return e.jsxs("nav",{className:`navbar ${h?"scrolled":""}`,children:[e.jsxs("div",{className:"navbar-container",children:[e.jsxs(P,{to:"/",className:"navbar-brand",children:[e.jsx("div",{className:"brand-icon",children:e.jsx(te,{size:26})}),e.jsxs("span",{className:"brand-text",children:["Flow",e.jsx("span",{className:"gradient-text",children:"Music"})]})]}),e.jsxs("form",{onSubmit:N,className:"navbar-search",children:[e.jsx(ee,{size:18,className:"search-icon"}),e.jsx("input",{type:"text",placeholder:"Rechercher artistes, titres, albums...",value:m,onChange:c=>u(c.target.value),className:"search-input"}),e.jsx("kbd",{className:"search-kbd",children:"⌘K"})]}),e.jsxs("div",{className:`navbar-nav ${p?"active":""}`,children:[e.jsxs(P,{to:"/",className:`nav-link ${y("/")?"active":""}`,children:[e.jsx(Ve,{size:20}),e.jsx("span",{children:"Accueil"})]}),e.jsxs(P,{to:"/explore",className:`nav-link ${y("/explore")?"active":""}`,children:[e.jsx(_e,{size:20}),e.jsx("span",{children:"Explorer"})]}),r&&e.jsxs(e.Fragment,{children:[e.jsxs(P,{to:"/library",className:`nav-link ${y("/library")?"active":""}`,children:[e.jsx(ce,{size:20}),e.jsx("span",{children:"Bibliothèque"})]}),e.jsxs(P,{to:"/upload",className:`nav-link upload-link ${y("/upload")?"active":""}`,children:[e.jsx(K,{size:20}),e.jsx("span",{children:"Upload"})]})]})]}),e.jsxs("div",{className:"navbar-actions",children:[r?e.jsxs(e.Fragment,{children:[e.jsxs("button",{className:"action-btn notifications-btn",title:"Notifications",children:[e.jsx(Ge,{size:20}),e.jsx("span",{className:"notification-dot"})]}),e.jsxs("div",{className:"user-menu-container",children:[e.jsxs("button",{className:"user-button",onClick:()=>b(!k),children:[e.jsx("div",{className:"avatar",children:s!=null&&s.avatarUrl?e.jsx("img",{src:s.avatarUrl,alt:s.username}):(g=s==null?void 0:s.username)==null?void 0:g.charAt(0).toUpperCase()}),e.jsx("span",{className:"user-name",children:s==null?void 0:s.username}),e.jsx(se,{size:16,className:k?"rotated":""})]}),k&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"menu-backdrop",onClick:()=>b(!1)}),e.jsxs("div",{className:"user-menu",children:[e.jsxs("div",{className:"user-menu-header",children:[e.jsx("div",{className:"avatar avatar-lg",children:(o=s==null?void 0:s.username)==null?void 0:o.charAt(0).toUpperCase()}),e.jsxs("div",{className:"user-menu-info",children:[e.jsx("span",{className:"user-menu-name",children:s==null?void 0:s.username}),e.jsx("span",{className:"user-menu-email",children:s==null?void 0:s.email})]})]}),e.jsx("div",{className:"user-menu-divider"}),e.jsxs(P,{to:"/profile",className:"user-menu-item",children:[e.jsx(Ce,{size:18}),e.jsx("span",{children:"Mon profil"})]}),e.jsxs(P,{to:"/library",className:"user-menu-item",children:[e.jsx(ce,{size:18}),e.jsx("span",{children:"Ma bibliothèque"})]}),e.jsxs("button",{className:"user-menu-item",children:[e.jsx(Se,{size:18}),e.jsx("span",{children:"Paramètres"})]}),e.jsx("div",{className:"user-menu-divider"}),e.jsxs("button",{onClick:x,className:"user-menu-item logout",children:[e.jsx(Je,{size:18}),e.jsx("span",{children:"Déconnexion"})]})]})]})]})]}):e.jsxs("div",{className:"auth-buttons",children:[e.jsx(P,{to:"/login",className:"btn btn-ghost",children:"Connexion"}),e.jsx(P,{to:"/register",className:"btn btn-primary",children:"S'inscrire"})]}),e.jsx("button",{className:"mobile-menu-btn",onClick:()=>v(!p),children:p?e.jsx(B,{size:24}):e.jsx(We,{size:24})})]})]}),p&&e.jsx("div",{className:"mobile-backdrop",onClick:()=>v(!1)})]})}function ws(){const{currentTrack:s,playlist:l,isPlaying:r,currentTime:d,duration:t,volume:m,shuffle:u,repeat:p,togglePlay:v,seek:k,playNext:b,playPrevious:h,setVolume:n,toggleShuffle:N,toggleRepeat:x,playTrack:y}=pe(),[g,o]=a.useState(!1),[c,j]=a.useState(!1),[z,M]=a.useState(!1),[C,A]=a.useState(!1),T=a.useRef(null),F=a.useRef(null),[V]=a.useState(Array(20).fill(0).map(()=>Math.random())),E=S=>{if(isNaN(S))return"0:00";const i=Math.floor(S/60),w=Math.floor(S%60);return`${i}:${w.toString().padStart(2,"0")}`},f=S=>{const i=T.current.getBoundingClientRect(),w=Math.max(0,Math.min(1,(S.clientX-i.left)/i.width));k(w*t)},U=S=>{if(!C)return;const i=T.current.getBoundingClientRect(),w=Math.max(0,Math.min(1,(S.clientX-i.left)/i.width));k(w*t)},q=S=>{const i=F.current.getBoundingClientRect(),w=Math.max(0,Math.min(1,(S.clientX-i.left)/i.width));n(w)};a.useEffect(()=>{const S=()=>A(!1),i=w=>U(w);return C&&(window.addEventListener("mousemove",i),window.addEventListener("mouseup",S)),()=>{window.removeEventListener("mousemove",i),window.removeEventListener("mouseup",S)}},[C]);const L=t?d/t*100:0,Z=()=>m===0?e.jsx(Ke,{size:20}):m<.5?e.jsx(Ze,{size:20}):e.jsx(Ye,{size:20});return s?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:`player glass-strong ${c?"expanded":""}`,children:[e.jsx("div",{className:"player-progress-top",ref:T,onClick:f,onMouseDown:()=>A(!0),children:e.jsx("div",{className:"progress-track",children:e.jsx("div",{className:"progress-fill",style:{width:`${L}%`}})})}),e.jsxs("div",{className:"player-container",children:[e.jsxs("div",{className:"player-track",children:[e.jsxs("div",{className:"track-cover",onClick:()=>j(!c),children:[s.coverUrl?e.jsx("img",{src:s.coverUrl,alt:s.title}):e.jsx("div",{className:"cover-placeholder",children:e.jsx($,{size:24})}),r&&e.jsx("div",{className:"cover-visualizer",children:V.slice(0,4).map((S,i)=>e.jsx("span",{style:{animationDelay:`${i*.1}s`,height:`${30+S*70}%`}},i))}),e.jsx("div",{className:"cover-expand",children:c?e.jsx(se,{size:20}):e.jsx(Qe,{size:20})})]}),e.jsxs("div",{className:"track-info",children:[e.jsx("div",{className:"track-title",children:s.title}),e.jsx("div",{className:"track-artist",children:s.artist||"Artiste inconnu"})]}),e.jsx("button",{className:`like-btn ${z?"active":""}`,onClick:()=>M(!z),title:z?"Retirer des favoris":"Ajouter aux favoris",children:e.jsx(O,{size:20,fill:z?"currentColor":"none"})})]}),e.jsxs("div",{className:"player-controls",children:[e.jsxs("div",{className:"controls-buttons",children:[e.jsx("button",{className:`control-btn control-secondary ${u?"active":""}`,onClick:N,title:"Lecture aléatoire",children:e.jsx(je,{size:18})}),e.jsx("button",{className:"control-btn",onClick:h,title:"Précédent",children:e.jsx(ve,{size:22,fill:"currentColor"})}),e.jsx("button",{className:"control-btn play-btn",onClick:v,children:e.jsx("div",{className:"play-btn-inner",children:r?e.jsx(ae,{size:26,fill:"currentColor"}):e.jsx(H,{size:26,fill:"currentColor"})})}),e.jsx("button",{className:"control-btn",onClick:b,title:"Suivant",children:e.jsx(Ne,{size:22,fill:"currentColor"})}),e.jsx("button",{className:`control-btn control-secondary ${p!=="none"?"active":""}`,onClick:x,title:p==="one"?"Répéter la piste":p==="all"?"Répéter tout":"Répéter",children:p==="one"?e.jsx(ge,{size:18}):e.jsx(fe,{size:18})})]}),e.jsxs("div",{className:"controls-progress",children:[e.jsx("span",{className:"time-current",children:E(d)}),e.jsx("div",{className:"progress-bar",ref:T,onClick:f,onMouseDown:()=>A(!0),children:e.jsx("div",{className:"progress-track",children:e.jsx("div",{className:"progress-fill",style:{width:`${L}%`},children:e.jsx("div",{className:"progress-thumb"})})})}),e.jsx("span",{className:"time-duration",children:E(t)})]})]}),e.jsxs("div",{className:"player-right",children:[e.jsx("div",{className:"mini-visualizer",children:V.slice(0,8).map((S,i)=>e.jsx("span",{className:r?"active":"",style:{animationDelay:`${i*.05}s`,height:r?`${20+S*80}%`:"20%"}},i))}),e.jsxs("div",{className:"player-volume",children:[e.jsx("button",{className:"volume-btn",onClick:()=>n(m>0?0:.7),title:m===0?"Activer le son":"Couper le son",children:Z()}),e.jsx("div",{className:"volume-bar",ref:F,onClick:q,children:e.jsx("div",{className:"volume-track",children:e.jsx("div",{className:"volume-fill",style:{width:`${m*100}%`},children:e.jsx("div",{className:"volume-thumb"})})})})]}),e.jsx("button",{className:`control-btn control-secondary ${g?"active":""}`,onClick:()=>o(!g),title:"File d'attente",children:e.jsx(Y,{size:20})}),e.jsx("button",{className:"control-btn control-secondary",onClick:()=>j(!c),title:"Agrandir",children:e.jsx(Xe,{size:18})})]})]})]}),g&&e.jsxs("div",{className:"queue-panel glass-strong",children:[e.jsxs("div",{className:"queue-header",children:[e.jsxs("h3",{children:[e.jsx(Y,{size:20}),"File d'attente"]}),e.jsx("button",{className:"queue-close",onClick:()=>o(!1),children:e.jsx(B,{size:20})})]}),e.jsxs("div",{className:"queue-current",children:[e.jsx("span",{className:"queue-label",children:"En cours de lecture"}),e.jsxs("div",{className:"queue-track active",children:[e.jsxs("div",{className:"queue-track-cover",children:[s.coverUrl?e.jsx("img",{src:s.coverUrl,alt:s.title}):e.jsx("div",{className:"cover-placeholder",children:e.jsx($,{size:16})}),e.jsxs("div",{className:"playing-indicator",children:[e.jsx("span",{}),e.jsx("span",{}),e.jsx("span",{})]})]}),e.jsxs("div",{className:"queue-track-info",children:[e.jsx("div",{className:"queue-track-title",children:s.title}),e.jsx("div",{className:"queue-track-artist",children:s.artist})]})]})]}),l.length>1&&e.jsxs("div",{className:"queue-next",children:[e.jsxs("span",{className:"queue-label",children:["À suivre (",l.length-1,")"]}),e.jsx("div",{className:"queue-list",children:l.filter(S=>S.id!==s.id).map((S,i)=>e.jsxs("div",{className:"queue-track",onClick:()=>y(S,l),children:[e.jsx("span",{className:"queue-index",children:i+1}),e.jsx("div",{className:"queue-track-cover",children:S.coverUrl?e.jsx("img",{src:S.coverUrl,alt:S.title}):e.jsx("div",{className:"cover-placeholder",children:e.jsx($,{size:14})})}),e.jsxs("div",{className:"queue-track-info",children:[e.jsx("div",{className:"queue-track-title",children:S.title}),e.jsx("div",{className:"queue-track-artist",children:S.artist})]}),e.jsx("div",{className:"queue-track-duration",children:S.duration?E(S.duration):"--:--"})]},S.id))})]}),l.length<=1&&e.jsxs("div",{className:"queue-empty",children:[e.jsx($,{size:32}),e.jsx("p",{children:"La file d'attente est vide"})]})]}),c&&e.jsxs("div",{className:"fullscreen-player",children:[e.jsx("div",{className:"fullscreen-bg",children:s.coverUrl&&e.jsx("img",{src:s.coverUrl,alt:""})}),e.jsx("button",{className:"fullscreen-close",onClick:()=>j(!1),children:e.jsx(se,{size:32})}),e.jsxs("div",{className:"fullscreen-content",children:[e.jsxs("div",{className:"fullscreen-cover",children:[s.coverUrl?e.jsx("img",{src:s.coverUrl,alt:s.title}):e.jsx("div",{className:"cover-placeholder",children:e.jsx($,{size:80})}),e.jsx("div",{className:`cover-ring ${r?"playing":""}`,children:e.jsx("div",{className:"ring-inner"})})]}),e.jsx("div",{className:"fullscreen-visualizer",children:V.map((S,i)=>e.jsx("span",{className:r?"active":"",style:{animationDelay:`${i*.05}s`,height:r?`${20+S*80}%`:"10%"}},i))}),e.jsxs("div",{className:"fullscreen-info",children:[e.jsx("h1",{children:s.title}),e.jsx("p",{children:s.artist||"Artiste inconnu"})]}),e.jsxs("div",{className:"fullscreen-progress",children:[e.jsx("div",{className:"progress-bar large",onClick:f,children:e.jsx("div",{className:"progress-track",children:e.jsx("div",{className:"progress-fill",style:{width:`${L}%`},children:e.jsx("div",{className:"progress-thumb"})})})}),e.jsxs("div",{className:"progress-times",children:[e.jsx("span",{children:E(d)}),e.jsx("span",{children:E(t)})]})]}),e.jsxs("div",{className:"fullscreen-controls",children:[e.jsx("button",{className:`control-btn control-secondary ${u?"active":""}`,onClick:N,children:e.jsx(je,{size:24})}),e.jsx("button",{className:"control-btn large",onClick:h,children:e.jsx(ve,{size:32,fill:"currentColor"})}),e.jsx("button",{className:"control-btn play-btn large",onClick:v,children:e.jsx("div",{className:"play-btn-inner",children:r?e.jsx(ae,{size:40,fill:"currentColor"}):e.jsx(H,{size:40,fill:"currentColor"})})}),e.jsx("button",{className:"control-btn large",onClick:b,children:e.jsx(Ne,{size:32,fill:"currentColor"})}),e.jsx("button",{className:`control-btn control-secondary ${p!=="none"?"active":""}`,onClick:x,children:p==="one"?e.jsx(ge,{size:24}):e.jsx(fe,{size:24})})]}),e.jsxs("div",{className:"fullscreen-actions",children:[e.jsx("button",{className:`action-btn ${z?"active":""}`,onClick:()=>M(!z),children:e.jsx(O,{size:24,fill:z?"currentColor":"none"})}),e.jsx("button",{className:"action-btn",children:e.jsx(we,{size:24})}),e.jsx("button",{className:"action-btn",onClick:()=>o(!g),children:e.jsx(Y,{size:24})})]})]})]})]}):e.jsx("div",{className:"player glass-strong",children:e.jsx("div",{className:"player-container",children:e.jsxs("div",{className:"player-empty",children:[e.jsx("div",{className:"player-empty-icon",children:e.jsx($,{size:22})}),e.jsx("span",{children:"Sélectionnez une piste pour commencer l'écoute"})]})})})}function G({track:s,tracks:l=[],variant:r="default",index:d,showRank:t=!1}){const{playTrack:m,currentTrack:u,isPlaying:p,togglePlay:v}=pe(),{isAuthenticated:k,token:b}=D(),[h,n]=a.useState(!1),[N,x]=a.useState(!1),[y,g]=a.useState(!1),o=(u==null?void 0:u.id)===s.id,c=C=>{C.stopPropagation(),o?v():m(s,l.length>0?l:[s])},j=async C=>{if(C.stopPropagation(),!!k){n(!h);try{await fetch(`/api/tracks/${s.id}/like`,{method:"POST",headers:{Authorization:`Bearer ${b}`}})}catch{n(!h)}}},z=C=>{if(!C)return"--:--";const A=Math.floor(C/60),T=Math.floor(C%60);return`${A}:${T.toString().padStart(2,"0")}`},M=C=>C?C>=1e6?`${(C/1e6).toFixed(1)}M`:C>=1e3?`${(C/1e3).toFixed(1)}K`:C.toString():"0";return r==="list"?e.jsxs("div",{className:`track-list-item ${o?"playing":""}`,onMouseEnter:()=>g(!0),onMouseLeave:()=>g(!1),children:[t&&e.jsx("span",{className:"track-rank",children:d}),e.jsxs("div",{className:"track-list-cover",onClick:c,children:[s.coverUrl?e.jsx("img",{src:s.coverUrl,alt:s.title}):e.jsx("div",{className:"cover-placeholder",children:e.jsx($,{size:20})}),e.jsx("div",{className:"track-list-play",children:o&&p?e.jsx(ae,{size:18}):e.jsx(H,{size:18})}),o&&p&&e.jsxs("div",{className:"playing-bars",children:[e.jsx("span",{}),e.jsx("span",{}),e.jsx("span",{})]})]}),e.jsxs("div",{className:"track-list-info",children:[e.jsx("div",{className:"track-list-title",children:s.title}),e.jsx("div",{className:"track-list-artist",children:s.artist||"Artiste inconnu"})]}),s.plays!==void 0&&e.jsxs("div",{className:"track-list-plays",children:[M(s.plays)," plays"]}),e.jsx("div",{className:"track-list-duration",children:z(s.duration)}),e.jsxs("div",{className:"track-list-actions",children:[e.jsx("button",{className:`action-btn ${h?"active":""}`,onClick:j,children:e.jsx(O,{size:18,fill:h?"currentColor":"none"})}),e.jsx("button",{className:"action-btn",children:e.jsx(be,{size:18})})]})]}):e.jsxs("div",{className:`track-card ${o?"playing":""} ${y?"hovered":""}`,onMouseEnter:()=>g(!0),onMouseLeave:()=>{g(!1),x(!1)},children:[t&&d&&e.jsx("div",{className:"track-rank-badge",children:e.jsxs("span",{className:"rank-number",children:["#",d]})}),e.jsxs("div",{className:"track-card-cover",onClick:c,children:[s.coverUrl?e.jsx("img",{src:s.coverUrl,alt:s.title,loading:"lazy"}):e.jsx("div",{className:"cover-placeholder",children:e.jsx($,{size:32})}),e.jsx("div",{className:"track-card-overlay",children:e.jsx("button",{className:"play-button",children:o&&p?e.jsx(ae,{size:26,fill:"currentColor"}):e.jsx(H,{size:26,fill:"currentColor"})})}),o&&p&&e.jsxs("div",{className:"playing-indicator",children:[e.jsx("span",{}),e.jsx("span",{}),e.jsx("span",{}),e.jsx("span",{})]}),e.jsx("div",{className:"cover-glow"})]}),e.jsxs("div",{className:"track-card-body",children:[e.jsxs("div",{className:"track-card-info",children:[e.jsx("h3",{className:"track-card-title",children:s.title}),e.jsx("p",{className:"track-card-artist",children:s.artist||"Artiste inconnu"}),s.plays!==void 0&&e.jsx("div",{className:"track-card-meta",children:e.jsxs("span",{className:"plays-count",children:[M(s.plays)," écoutes"]})})]}),e.jsxs("div",{className:"track-card-actions",children:[e.jsx("button",{className:`action-btn like-btn ${h?"active":""}`,onClick:j,title:h?"Retirer des favoris":"Ajouter aux favoris",children:e.jsx(O,{size:18,fill:h?"currentColor":"none"})}),e.jsxs("div",{className:"more-menu-container",children:[e.jsx("button",{className:"action-btn more-btn",onClick:C=>{C.stopPropagation(),x(!N)},children:e.jsx(be,{size:18})}),N&&e.jsxs("div",{className:"more-menu",children:[e.jsxs("button",{className:"menu-item",onClick:C=>C.stopPropagation(),children:[e.jsx(Y,{size:16}),e.jsx("span",{children:"Ajouter à une playlist"})]}),e.jsxs("button",{className:"menu-item",onClick:C=>C.stopPropagation(),children:[e.jsx(oe,{size:16}),e.jsx("span",{children:"Ajouter à la file"})]}),e.jsxs("button",{className:"menu-item",onClick:C=>C.stopPropagation(),children:[e.jsx(we,{size:16}),e.jsx("span",{children:"Partager"})]})]})]})]})]})]})}const Ps=[{id:1,title:"Nuit Étoilée",artist:"Luna Wave",coverUrl:"https://picsum.photos/seed/track1/300/300",duration:234,plays:15420},{id:2,title:"Horizon Lointain",artist:"Solar Beats",coverUrl:"https://picsum.photos/seed/track2/300/300",duration:198,plays:12300},{id:3,title:"Rêves Électriques",artist:"Neon Dreams",coverUrl:"https://picsum.photos/seed/track3/300/300",duration:267,plays:9800},{id:4,title:"Voyage Nocturne",artist:"Midnight Sun",coverUrl:"https://picsum.photos/seed/track4/300/300",duration:312,plays:8500},{id:5,title:"Éclat de Lune",artist:"Aurora",coverUrl:"https://picsum.photos/seed/track5/300/300",duration:245,plays:7200},{id:6,title:"Cascade Sonore",artist:"Flow State",coverUrl:"https://picsum.photos/seed/track6/300/300",duration:289,plays:6100},{id:7,title:"Aurore Boréale",artist:"Nordic Pulse",coverUrl:"https://picsum.photos/seed/track7/300/300",duration:201,plays:5400},{id:8,title:"Tempête de Feu",artist:"Blaze",coverUrl:"https://picsum.photos/seed/track8/300/300",duration:276,plays:4900}],Us=[{id:9,title:"Mélodie du Soir",artist:"Twilight",coverUrl:"https://picsum.photos/seed/track9/300/300",duration:223,plays:3200},{id:10,title:"Battement de Coeur",artist:"Pulse",coverUrl:"https://picsum.photos/seed/track10/300/300",duration:256,plays:2800},{id:11,title:"Onde de Choc",artist:"Impact",coverUrl:"https://picsum.photos/seed/track11/300/300",duration:189,plays:2100},{id:12,title:"Symphonie Urbaine",artist:"City Lights",coverUrl:"https://picsum.photos/seed/track12/300/300",duration:301,plays:1900}],Ms=[{id:"electronic",name:"Électronique",color:"#7c3aed",icon:es},{id:"hiphop",name:"Hip-Hop",color:"#f59e0b",icon:ss},{id:"rock",name:"Rock",color:"#ef4444",icon:as},{id:"pop",name:"Pop",color:"#ec4899",icon:ts}];function $s(){const{isAuthenticated:s,user:l}=D(),{playTrack:r}=pe(),[d,t]=a.useState(Ps),[m,u]=a.useState(Us),[p,v]=a.useState({tracks:1e4,users:5e3,plays:1e6}),[k,b]=a.useState(!0);a.useEffect(()=>{const n=new AbortController,N=async()=>{var y;try{const g=fetch("/api/tracks/trending",{signal:n.signal}).then(z=>z.ok?z.json():null).catch(()=>null),o=fetch("/api/stats",{signal:n.signal}).then(z=>z.ok?z.json():null).catch(()=>null),[c,j]=await Promise.all([g,o]);((y=c==null?void 0:c.tracks)==null?void 0:y.length)>0&&t(c.tracks),j!=null&&j.stats&&v({tracks:j.stats.tracks||1e4,users:j.stats.users||5e3,plays:j.stats.plays||1e6})}catch{console.log("Utilisation des données de démo")}finally{b(!1)}},x=setTimeout(()=>{b(!1)},5e3);return N(),()=>{n.abort(),clearTimeout(x)}},[]);const h=n=>n>=1e6?`${(n/1e6).toFixed(1)}M`:n>=1e3?`${(n/1e3).toFixed(1)}K`:n.toString();return e.jsxs("div",{className:"home-page",children:[e.jsxs("section",{className:"hero",children:[e.jsxs("div",{className:"hero-background",children:[e.jsx("div",{className:"hero-gradient"}),e.jsxs("div",{className:"hero-orbs",children:[e.jsx("div",{className:"orb orb-1"}),e.jsx("div",{className:"orb orb-2"}),e.jsx("div",{className:"orb orb-3"})]}),e.jsx("div",{className:"hero-grid"})]}),e.jsxs("div",{className:"container",children:[e.jsxs("div",{className:"hero-content",children:[e.jsxs("div",{className:"hero-badge animate-fadeIn",children:[e.jsx(_,{size:14}),e.jsx("span",{children:"Plateforme de streaming musical"})]}),e.jsxs("h1",{className:"hero-title animate-fadeIn delay-1",children:["Découvrez la musique",e.jsx("span",{className:"gradient-text",children:" autrement"})]}),e.jsx("p",{className:"hero-subtitle animate-fadeIn delay-2",children:"Partagez vos créations, découvrez de nouveaux artistes et rejoignez une communauté passionnée de musique."}),e.jsx("div",{className:"hero-actions animate-fadeIn delay-3",children:s?e.jsxs(e.Fragment,{children:[e.jsxs(P,{to:"/upload",className:"btn btn-primary btn-lg",children:[e.jsx(K,{size:20}),"Uploader ma musique"]}),e.jsxs(P,{to:"/explore",className:"btn btn-secondary btn-lg",children:[e.jsx(re,{size:20}),"Explorer"]})]}):e.jsxs(e.Fragment,{children:[e.jsxs(P,{to:"/register",className:"btn btn-primary btn-xl",children:[e.jsx(_,{size:20}),"Commencer gratuitement"]}),e.jsxs(P,{to:"/explore",className:"btn btn-secondary btn-lg",children:[e.jsx(H,{size:20}),"Écouter maintenant"]})]})}),e.jsxs("div",{className:"hero-stats animate-fadeIn delay-4",children:[e.jsxs("div",{className:"stat",children:[e.jsx("div",{className:"stat-icon",children:e.jsx(te,{size:24})}),e.jsxs("div",{className:"stat-info",children:[e.jsxs("span",{className:"stat-value",children:[h(p.tracks),"+"]}),e.jsx("span",{className:"stat-label",children:"Pistes"})]})]}),e.jsx("div",{className:"stat-divider"}),e.jsxs("div",{className:"stat",children:[e.jsx("div",{className:"stat-icon",children:e.jsx(ye,{size:24})}),e.jsxs("div",{className:"stat-info",children:[e.jsxs("span",{className:"stat-value",children:[h(p.users),"+"]}),e.jsx("span",{className:"stat-label",children:"Artistes"})]})]}),e.jsx("div",{className:"stat-divider"}),e.jsxs("div",{className:"stat",children:[e.jsx("div",{className:"stat-icon",children:e.jsx(re,{size:24})}),e.jsxs("div",{className:"stat-info",children:[e.jsxs("span",{className:"stat-value",children:[h(p.plays),"+"]}),e.jsx("span",{className:"stat-label",children:"Écoutes"})]})]})]})]}),e.jsx("div",{className:"hero-visual",children:e.jsx("div",{className:"floating-cards",children:d.slice(0,3).map((n,N)=>e.jsxs("div",{className:`floating-card floating-card-${N+1}`,onClick:()=>r(n,d),children:[e.jsx("img",{src:n.coverUrl,alt:n.title}),e.jsxs("div",{className:"floating-card-info",children:[e.jsx("span",{className:"track-name",children:n.title}),e.jsx("span",{className:"artist-name",children:n.artist})]}),e.jsx("div",{className:"floating-card-play",children:e.jsx(H,{size:20,fill:"white"})})]},n.id))})})]})]}),e.jsx("section",{className:"section genres-section",children:e.jsx("div",{className:"container",children:e.jsx("div",{className:"genres-grid",children:Ms.map((n,N)=>{const x=n.icon;return e.jsxs(P,{to:`/explore?genre=${n.id}`,className:"genre-card animate-fadeInUp",style:{animationDelay:`${N*.1}s`,"--genre-color":n.color},children:[e.jsx("div",{className:"genre-icon",children:e.jsx(x,{size:28})}),e.jsx("span",{className:"genre-name",children:n.name}),e.jsx("div",{className:"genre-glow"})]},n.id)})})})}),e.jsx("section",{className:"section",children:e.jsxs("div",{className:"container",children:[e.jsxs("div",{className:"section-header",children:[e.jsxs("h2",{className:"section-title",children:[e.jsx(de,{}),"Tendances"]}),e.jsxs(P,{to:"/explore?sort=trending",className:"section-link",children:["Voir tout ",e.jsx(ne,{size:16})]})]}),e.jsx("div",{className:"grid grid-4","data-stagger":!0,children:d.slice(0,4).map((n,N)=>e.jsx("div",{className:"animate-fadeInUp",children:e.jsx(G,{track:n,tracks:d,index:N+1,showRank:!0})},n.id))})]})}),e.jsx("section",{className:"section",children:e.jsxs("div",{className:"container",children:[e.jsxs("div",{className:"section-header",children:[e.jsxs("h2",{className:"section-title",children:[e.jsx(_,{}),"Nouveautés"]}),e.jsxs(P,{to:"/explore?sort=new",className:"section-link",children:["Voir tout ",e.jsx(ne,{size:16})]})]}),e.jsx("div",{className:"grid grid-4","data-stagger":!0,children:d.slice(4,8).map((n,N)=>e.jsx("div",{className:"animate-fadeInUp",children:e.jsx(G,{track:n,tracks:d.slice(4,8)})},n.id))})]})}),s&&e.jsx("section",{className:"section",children:e.jsxs("div",{className:"container",children:[e.jsxs("div",{className:"section-header",children:[e.jsxs("h2",{className:"section-title",children:[e.jsx(Pe,{}),"Écoutés récemment"]}),e.jsxs(P,{to:"/library",className:"section-link",children:["Ma bibliothèque ",e.jsx(ne,{size:16})]})]}),e.jsx("div",{className:"grid grid-4","data-stagger":!0,children:m.map((n,N)=>e.jsx("div",{className:"animate-fadeInUp",children:e.jsx(G,{track:n,tracks:m})},n.id))})]})}),e.jsx("section",{className:"section features-section",children:e.jsxs("div",{className:"container",children:[e.jsxs("div",{className:"features-header",children:[e.jsx("h2",{className:"features-title",children:"Pourquoi FlowMusic ?"}),e.jsx("p",{className:"features-subtitle",children:"La plateforme idéale pour les artistes et les passionnés de musique"})]}),e.jsxs("div",{className:"features-grid",children:[e.jsxs("div",{className:"feature-card animate-fadeInUp",children:[e.jsx("div",{className:"feature-icon",children:e.jsx(K,{size:28})}),e.jsx("h3",{children:"Upload illimité"}),e.jsx("p",{children:"Partagez autant de pistes que vous le souhaitez, sans restrictions"})]}),e.jsxs("div",{className:"feature-card animate-fadeInUp delay-1",children:[e.jsx("div",{className:"feature-icon",children:e.jsx(re,{size:28})}),e.jsx("h3",{children:"Audio haute qualité"}),e.jsx("p",{children:"Écoutez et partagez votre musique en qualité studio"})]}),e.jsxs("div",{className:"feature-card animate-fadeInUp delay-2",children:[e.jsx("div",{className:"feature-icon",children:e.jsx(ye,{size:28})}),e.jsx("h3",{children:"Communauté active"}),e.jsx("p",{children:"Connectez-vous avec d'autres artistes et fans de musique"})]}),e.jsxs("div",{className:"feature-card animate-fadeInUp delay-3",children:[e.jsx("div",{className:"feature-icon",children:e.jsx(de,{size:28})}),e.jsx("h3",{children:"Statistiques détaillées"}),e.jsx("p",{children:"Suivez vos performances avec des analytics complets"})]})]})]})}),!s&&e.jsx("section",{className:"cta-section",children:e.jsx("div",{className:"container",children:e.jsxs("div",{className:"cta-card",children:[e.jsx("div",{className:"cta-background",children:e.jsxs("div",{className:"cta-orbs",children:[e.jsx("div",{className:"cta-orb cta-orb-1"}),e.jsx("div",{className:"cta-orb cta-orb-2"})]})}),e.jsxs("div",{className:"cta-content",children:[e.jsx("h2",{className:"cta-title",children:"Prêt à partager votre musique ?"}),e.jsx("p",{className:"cta-text",children:"Rejoignez FlowMusic et faites découvrir vos créations à des milliers d'auditeurs passionnés."}),e.jsxs(P,{to:"/register",className:"btn btn-primary btn-xl",children:[e.jsx(_,{size:20}),"Créer mon compte gratuitement"]})]})]})})})]})}function As(){const s=J(),{login:l}=D(),[r,d]=a.useState({email:"",password:""}),[t,m]=a.useState(!1),[u,p]=a.useState(""),[v,k]=a.useState(!1),b=n=>{d({...r,[n.target.name]:n.target.value}),p("")},h=async n=>{n.preventDefault(),k(!0),p("");try{await l(r.email,r.password),s("/")}catch(N){p(N.message||"Erreur de connexion")}finally{k(!1)}};return e.jsxs("div",{className:"auth-page",children:[e.jsx("div",{className:"auth-container",children:e.jsxs("div",{className:"auth-card glass animate-fadeIn",children:[e.jsxs("div",{className:"auth-header",children:[e.jsxs(P,{to:"/",className:"auth-logo",children:[e.jsx("div",{className:"logo-icon",children:e.jsx(te,{size:28})}),e.jsxs("span",{children:["Flow",e.jsx("span",{className:"gradient-text",children:"Music"})]})]}),e.jsx("h1",{className:"auth-title",children:"Bon retour parmi nous !"}),e.jsx("p",{className:"auth-subtitle",children:"Connectez-vous pour accéder à votre musique"})]}),e.jsxs("form",{onSubmit:h,className:"auth-form",children:[u&&e.jsx("div",{className:"auth-error animate-fadeIn",children:u}),e.jsxs("div",{className:"input-group",children:[e.jsx("label",{className:"input-label",children:"Email"}),e.jsxs("div",{className:"input-icon",children:[e.jsx(xe,{}),e.jsx("input",{type:"email",name:"email",value:r.email,onChange:b,className:"input",placeholder:"votre@email.com",required:!0})]})]}),e.jsxs("div",{className:"input-group",children:[e.jsx("label",{className:"input-label",children:"Mot de passe"}),e.jsxs("div",{className:"input-icon",children:[e.jsx(ue,{}),e.jsx("input",{type:t?"text":"password",name:"password",value:r.password,onChange:b,className:"input",placeholder:"••••••••",required:!0}),e.jsx("button",{type:"button",className:"password-toggle",onClick:()=>m(!t),children:t?e.jsx(Ue,{size:20}):e.jsx(Me,{size:20})})]})]}),e.jsxs("div",{className:"auth-options",children:[e.jsxs("label",{className:"checkbox-label",children:[e.jsx("input",{type:"checkbox"}),e.jsx("span",{children:"Se souvenir de moi"})]}),e.jsx(P,{to:"/forgot-password",className:"auth-link",children:"Mot de passe oublié ?"})]}),e.jsx("button",{type:"submit",className:"btn btn-primary btn-lg auth-submit",disabled:v,children:v?e.jsx("div",{className:"spinner",style:{width:20,height:20}}):"Se connecter"})]}),e.jsx("div",{className:"divider",children:"ou continuer avec"}),e.jsxs("div",{className:"social-buttons",children:[e.jsxs("button",{className:"btn btn-secondary social-btn",children:[e.jsxs("svg",{viewBox:"0 0 24 24",width:"20",height:"20",children:[e.jsx("path",{fill:"currentColor",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),e.jsx("path",{fill:"currentColor",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),e.jsx("path",{fill:"currentColor",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"}),e.jsx("path",{fill:"currentColor",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]}),"Google"]}),e.jsxs("button",{className:"btn btn-secondary social-btn",children:[e.jsx("svg",{viewBox:"0 0 24 24",width:"20",height:"20",children:e.jsx("path",{fill:"currentColor",d:"M12 0C5.37 0 0 5.37 0 12c0 5.31 3.435 9.795 8.205 11.385.6.105.825-.255.825-.57 0-.285-.015-1.23-.015-2.235-3.015.555-3.795-.735-4.035-1.41-.135-.345-.72-1.41-1.23-1.695-.42-.225-1.02-.78-.015-.795.945-.015 1.62.87 1.845 1.23 1.08 1.815 2.805 1.305 3.495.99.105-.78.42-1.305.765-1.605-2.67-.3-5.46-1.335-5.46-5.925 0-1.305.465-2.385 1.23-3.225-.12-.3-.54-1.53.12-3.18 0 0 1.005-.315 3.3 1.23.96-.27 1.98-.405 3-.405s2.04.135 3 .405c2.295-1.56 3.3-1.23 3.3-1.23.66 1.65.24 2.88.12 3.18.765.84 1.23 1.905 1.23 3.225 0 4.605-2.805 5.625-5.475 5.925.435.375.81 1.095.81 2.22 0 1.605-.015 2.895-.015 3.3 0 .315.225.69.825.57A12.02 12.02 0 0024 12c0-6.63-5.37-12-12-12z"})}),"GitHub"]})]}),e.jsxs("p",{className:"auth-footer",children:["Pas encore de compte ?"," ",e.jsx(P,{to:"/register",className:"auth-link",children:"S'inscrire gratuitement"})]})]})}),e.jsx("div",{className:"auth-visual",children:e.jsxs("div",{className:"visual-content",children:[e.jsxs("div",{className:"visual-circles",children:[e.jsx("div",{className:"v-circle v-circle-1"}),e.jsx("div",{className:"v-circle v-circle-2"}),e.jsx("div",{className:"v-circle v-circle-3"})]}),e.jsxs("div",{className:"visual-text",children:[e.jsx("h2",{children:"Votre musique vous attend"}),e.jsx("p",{children:"Écoutez vos titres favoris, découvrez de nouveaux artistes et partagez vos créations."})]})]})})]})}function qs(){const s=J(),{register:l}=D(),[r,d]=a.useState({username:"",email:"",password:"",confirmPassword:""}),[t,m]=a.useState(!1),[u,p]=a.useState(""),[v,k]=a.useState(!1),b=x=>{d({...r,[x.target.name]:x.target.value}),p("")},n=(x=>({length:x.length>=8,lowercase:/[a-z]/.test(x),uppercase:/[A-Z]/.test(x),number:/[0-9]/.test(x)}))(r.password),N=async x=>{if(x.preventDefault(),r.password!==r.confirmPassword){p("Les mots de passe ne correspondent pas");return}if(!Object.values(n).every(Boolean)){p("Le mot de passe ne respecte pas les critères");return}k(!0),p("");try{await l(r.username,r.email,r.password),s("/")}catch(y){p(y.message||"Erreur lors de l'inscription")}finally{k(!1)}};return e.jsxs("div",{className:"auth-page",children:[e.jsx("div",{className:"auth-container",children:e.jsxs("div",{className:"auth-card glass animate-fadeIn",children:[e.jsxs("div",{className:"auth-header",children:[e.jsxs(P,{to:"/",className:"auth-logo",children:[e.jsx("div",{className:"logo-icon",children:e.jsx(te,{size:28})}),e.jsxs("span",{children:["Flow",e.jsx("span",{className:"gradient-text",children:"Music"})]})]}),e.jsx("h1",{className:"auth-title",children:"Créez votre compte"}),e.jsx("p",{className:"auth-subtitle",children:"Rejoignez la communauté FlowMusic"})]}),e.jsxs("form",{onSubmit:N,className:"auth-form",children:[u&&e.jsx("div",{className:"auth-error animate-fadeIn",children:u}),e.jsxs("div",{className:"input-group",children:[e.jsx("label",{className:"input-label",children:"Nom d'utilisateur"}),e.jsxs("div",{className:"input-icon",children:[e.jsx(Ce,{}),e.jsx("input",{type:"text",name:"username",value:r.username,onChange:b,className:"input",placeholder:"votre_pseudo",required:!0})]})]}),e.jsxs("div",{className:"input-group",children:[e.jsx("label",{className:"input-label",children:"Email"}),e.jsxs("div",{className:"input-icon",children:[e.jsx(xe,{}),e.jsx("input",{type:"email",name:"email",value:r.email,onChange:b,className:"input",placeholder:"votre@email.com",required:!0})]})]}),e.jsxs("div",{className:"input-group",children:[e.jsx("label",{className:"input-label",children:"Mot de passe"}),e.jsxs("div",{className:"input-icon",children:[e.jsx(ue,{}),e.jsx("input",{type:t?"text":"password",name:"password",value:r.password,onChange:b,className:"input",placeholder:"••••••••",required:!0}),e.jsx("button",{type:"button",className:"password-toggle",onClick:()=>m(!t),children:t?e.jsx(Ue,{size:20}):e.jsx(Me,{size:20})})]}),r.password&&e.jsxs("div",{className:"password-requirements",children:[e.jsxs("div",{className:`requirement ${n.length?"valid":""}`,children:[e.jsx(Q,{size:14}),e.jsx("span",{children:"Au moins 8 caractères"})]}),e.jsxs("div",{className:`requirement ${n.lowercase?"valid":""}`,children:[e.jsx(Q,{size:14}),e.jsx("span",{children:"Une lettre minuscule"})]}),e.jsxs("div",{className:`requirement ${n.uppercase?"valid":""}`,children:[e.jsx(Q,{size:14}),e.jsx("span",{children:"Une lettre majuscule"})]}),e.jsxs("div",{className:`requirement ${n.number?"valid":""}`,children:[e.jsx(Q,{size:14}),e.jsx("span",{children:"Un chiffre"})]})]})]}),e.jsxs("div",{className:"input-group",children:[e.jsx("label",{className:"input-label",children:"Confirmer le mot de passe"}),e.jsxs("div",{className:"input-icon",children:[e.jsx(ue,{}),e.jsx("input",{type:t?"text":"password",name:"confirmPassword",value:r.confirmPassword,onChange:b,className:"input",placeholder:"••••••••",required:!0})]})]}),e.jsx("div",{className:"auth-options",children:e.jsxs("label",{className:"checkbox-label",children:[e.jsx("input",{type:"checkbox",required:!0}),e.jsxs("span",{children:["J'accepte les ",e.jsx(P,{to:"/terms",className:"auth-link",children:"conditions d'utilisation"})]})]})}),e.jsx("button",{type:"submit",className:"btn btn-primary btn-lg auth-submit",disabled:v,children:v?e.jsx("div",{className:"spinner",style:{width:20,height:20}}):"Créer mon compte"})]}),e.jsx("div",{className:"divider",children:"ou continuer avec"}),e.jsxs("div",{className:"social-buttons",children:[e.jsxs("button",{className:"btn btn-secondary social-btn",children:[e.jsxs("svg",{viewBox:"0 0 24 24",width:"20",height:"20",children:[e.jsx("path",{fill:"currentColor",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),e.jsx("path",{fill:"currentColor",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),e.jsx("path",{fill:"currentColor",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"}),e.jsx("path",{fill:"currentColor",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]}),"Google"]}),e.jsxs("button",{className:"btn btn-secondary social-btn",children:[e.jsx("svg",{viewBox:"0 0 24 24",width:"20",height:"20",children:e.jsx("path",{fill:"currentColor",d:"M12 0C5.37 0 0 5.37 0 12c0 5.31 3.435 9.795 8.205 11.385.6.105.825-.255.825-.57 0-.285-.015-1.23-.015-2.235-3.015.555-3.795-.735-4.035-1.41-.135-.345-.72-1.41-1.23-1.695-.42-.225-1.02-.78-.015-.795.945-.015 1.62.87 1.845 1.23 1.08 1.815 2.805 1.305 3.495.99.105-.78.42-1.305.765-1.605-2.67-.3-5.46-1.335-5.46-5.925 0-1.305.465-2.385 1.23-3.225-.12-.3-.54-1.53.12-3.18 0 0 1.005-.315 3.3 1.23.96-.27 1.98-.405 3-.405s2.04.135 3 .405c2.295-1.56 3.3-1.23 3.3-1.23.66 1.65.24 2.88.12 3.18.765.84 1.23 1.905 1.23 3.225 0 4.605-2.805 5.625-5.475 5.925.435.375.81 1.095.81 2.22 0 1.605-.015 2.895-.015 3.3 0 .315.225.69.825.57A12.02 12.02 0 0024 12c0-6.63-5.37-12-12-12z"})}),"GitHub"]})]}),e.jsxs("p",{className:"auth-footer",children:["Déjà un compte ?"," ",e.jsx(P,{to:"/login",className:"auth-link",children:"Se connecter"})]})]})}),e.jsx("div",{className:"auth-visual",children:e.jsxs("div",{className:"visual-content",children:[e.jsxs("div",{className:"visual-circles",children:[e.jsx("div",{className:"v-circle v-circle-1"}),e.jsx("div",{className:"v-circle v-circle-2"}),e.jsx("div",{className:"v-circle v-circle-3"})]}),e.jsxs("div",{className:"visual-text",children:[e.jsx("h2",{children:"Partagez votre musique"}),e.jsx("p",{children:"Uploadez vos créations, créez des playlists et connectez-vous avec d'autres artistes."})]})]})})]})}function Ls(){const s=J(),{user:l,token:r,isAuthenticated:d}=D(),t=a.useRef(null),m=a.useRef(null),[u,p]=a.useState({title:"",artist:"",album:"",genre:"",description:""}),[v,k]=a.useState(null),[b,h]=a.useState(null),[n,N]=a.useState(null),[x,y]=a.useState(!1),[g,o]=a.useState(0),[c,j]=a.useState(""),[z,M]=a.useState(!1),[C,A]=a.useState(!1),[T,F]=a.useState(!1),[V,E]=a.useState(!1);if(!d)return e.jsx("div",{className:"page",children:e.jsx("div",{className:"container",children:e.jsxs("div",{className:"upload-auth-required glass",children:[e.jsx("div",{className:"auth-required-icon",children:e.jsx(X,{size:56})}),e.jsx("h2",{children:"Connexion requise"}),e.jsx("p",{children:"Vous devez être connecté pour uploader de la musique."}),e.jsx("button",{onClick:()=>s("/login"),className:"btn btn-primary btn-lg",children:"Se connecter"})]})})});const f=i=>{p({...u,[i.target.name]:i.target.value})},U=i=>{i&&(i.type.startsWith("audio/")||i.name.match(/\.(mp3|wav|flac|ogg|m4a)$/i)?(k(i),u.title||p(w=>({...w,title:i.name.replace(/\.[^/.]+$/,"")})),j("")):j("Veuillez sélectionner un fichier audio valide (MP3, WAV, FLAC, OGG)"))},q=i=>{if(i)if(i.type.startsWith("image/")){h(i);const w=new FileReader;w.onload=R=>N(R.target.result),w.readAsDataURL(i),j("")}else j("Veuillez sélectionner une image valide")},L=a.useCallback((i,w="audio")=>{i.preventDefault(),i.stopPropagation(),i.type==="dragenter"||i.type==="dragover"?w==="audio"?F(!0):E(!0):i.type==="dragleave"&&(w==="audio"?F(!1):E(!1))},[]),Z=a.useCallback((i,w="audio")=>{i.preventDefault(),i.stopPropagation(),w==="audio"?(F(!1),i.dataTransfer.files&&i.dataTransfer.files[0]&&U(i.dataTransfer.files[0])):(E(!1),i.dataTransfer.files&&i.dataTransfer.files[0]&&q(i.dataTransfer.files[0]))},[]),S=async i=>{if(i.preventDefault(),!v){j("Veuillez sélectionner un fichier audio");return}if(!u.title.trim()){j("Veuillez entrer un titre");return}y(!0),o(0),j("");try{const w=new FormData;w.append("audio",v),b&&w.append("cover",b),w.append("title",u.title),w.append("artist",u.artist||l.username),w.append("album",u.album),w.append("genre",u.genre),w.append("description",u.description);const R=new XMLHttpRequest;R.upload.addEventListener("progress",W=>{if(W.lengthComputable){const Le=Math.round(W.loaded/W.total*100);o(Le)}}),R.addEventListener("load",()=>{if(R.status>=200&&R.status<300)o(100),M(!0),setTimeout(()=>{s("/library")},2e3);else{const W=JSON.parse(R.responseText);throw new Error(W.message||"Erreur lors de l'upload")}}),R.addEventListener("error",()=>{throw new Error("Erreur réseau lors de l'upload")}),R.open("POST","/api/tracks/upload"),R.setRequestHeader("Authorization",`Bearer ${r}`),R.send(w)}catch(w){j(w.message||"Erreur lors de l'upload"),o(0),y(!1)}};return z?e.jsx("div",{className:"page",children:e.jsx("div",{className:"container",children:e.jsxs("div",{className:"upload-success glass animate-fadeInScale",children:[e.jsxs("div",{className:"success-icon",children:[e.jsx("div",{className:"success-ring"}),e.jsx(Q,{size:56})]}),e.jsx("h2",{children:"Upload réussi !"}),e.jsx("p",{children:"Votre piste a été ajoutée à votre bibliothèque."}),e.jsxs("div",{className:"success-loader",children:[e.jsx("span",{children:"Redirection vers votre bibliothèque"}),e.jsxs("div",{className:"loading-dots",children:[e.jsx("span",{}),e.jsx("span",{}),e.jsx("span",{})]})]})]})})}):e.jsx("div",{className:"page upload-page",children:e.jsxs("div",{className:"container",children:[e.jsxs("div",{className:"page-header",children:[e.jsxs("h1",{className:"page-title",children:[e.jsx(K,{className:"title-icon"}),"Uploader une piste"]}),e.jsx("p",{className:"page-subtitle",children:"Partagez votre musique avec la communauté FlowMusic"})]}),e.jsx("form",{onSubmit:S,className:"upload-form",children:e.jsxs("div",{className:"upload-grid",children:[e.jsxs("div",{className:"upload-zones",children:[e.jsxs("div",{className:`upload-zone ${v?"has-file":""} ${T?"drag-active":""}`,onClick:()=>{var i;return(i=t.current)==null?void 0:i.click()},onDragEnter:i=>L(i,"audio"),onDragOver:i=>L(i,"audio"),onDragLeave:i=>L(i,"audio"),onDrop:i=>Z(i,"audio"),children:[e.jsx("input",{ref:t,type:"file",accept:"audio/*,.mp3,.wav,.flac,.ogg,.m4a",onChange:i=>U(i.target.files[0]),hidden:!0}),v?e.jsxs("div",{className:"file-preview",children:[e.jsxs("div",{className:"file-icon audio-icon",children:[e.jsx(is,{size:36}),e.jsx("div",{className:"file-icon-ring"})]}),e.jsxs("div",{className:"file-info",children:[e.jsx("span",{className:"file-name",children:v.name}),e.jsxs("span",{className:"file-size",children:[(v.size/(1024*1024)).toFixed(2)," MB"]})]}),e.jsx("button",{type:"button",className:"remove-file",onClick:i=>{i.stopPropagation(),k(null)},children:e.jsx(B,{size:20})})]}):e.jsxs("div",{className:"upload-placeholder",children:[e.jsxs("div",{className:"upload-icon-wrapper",children:[e.jsx("div",{className:"upload-icon-bg"}),e.jsx($,{size:40})]}),e.jsxs("div",{className:"upload-text-content",children:[e.jsx("p",{className:"upload-text",children:"Glissez-déposez votre fichier audio ici"}),e.jsxs("p",{className:"upload-text-alt",children:["ou ",e.jsx("span",{children:"parcourir"})]})]}),e.jsx("p",{className:"upload-hint",children:"MP3, WAV, FLAC, OGG • Max 50MB"})]}),e.jsxs("div",{className:"upload-zone-decoration",children:[e.jsx("div",{className:"decoration-line line-1"}),e.jsx("div",{className:"decoration-line line-2"}),e.jsx("div",{className:"decoration-line line-3"})]})]}),e.jsxs("div",{className:`upload-zone cover-zone ${n?"has-file":""} ${V?"drag-active":""}`,onClick:()=>{var i;return(i=m.current)==null?void 0:i.click()},onDragEnter:i=>L(i,"cover"),onDragOver:i=>L(i,"cover"),onDragLeave:i=>L(i,"cover"),onDrop:i=>Z(i,"cover"),children:[e.jsx("input",{ref:m,type:"file",accept:"image/*",onChange:i=>q(i.target.files[0]),hidden:!0}),n?e.jsxs("div",{className:"cover-preview",children:[e.jsx("img",{src:n,alt:"Cover preview"}),e.jsx("div",{className:"cover-preview-overlay",children:e.jsx("span",{children:"Changer la pochette"})}),e.jsx("button",{type:"button",className:"remove-file",onClick:i=>{i.stopPropagation(),h(null),N(null)},children:e.jsx(B,{size:20})})]}):e.jsxs("div",{className:"upload-placeholder",children:[e.jsx("div",{className:"upload-icon-wrapper small",children:e.jsx(rs,{size:32})}),e.jsxs("p",{className:"upload-text",children:["Ajouter une ",e.jsx("span",{children:"pochette"})]}),e.jsx("p",{className:"upload-hint",children:"JPG, PNG • Carré recommandé"})]})]})]}),e.jsxs("div",{className:"upload-metadata glass",children:[e.jsxs("div",{className:"metadata-header",children:[e.jsx(_,{size:20}),e.jsx("h3",{children:"Informations de la piste"})]}),c&&e.jsxs("div",{className:"auth-error animate-fadeIn",children:[e.jsx(X,{size:18}),c]}),e.jsxs("div",{className:"input-group",children:[e.jsx("label",{className:"input-label",children:"Titre *"}),e.jsx("input",{type:"text",name:"title",value:u.title,onChange:f,className:"input",placeholder:"Titre de la piste",required:!0})]}),e.jsxs("div",{className:"input-group",children:[e.jsx("label",{className:"input-label",children:"Artiste"}),e.jsx("input",{type:"text",name:"artist",value:u.artist,onChange:f,className:"input",placeholder:(l==null?void 0:l.username)||"Nom de l'artiste"})]}),e.jsxs("div",{className:"input-row",children:[e.jsxs("div",{className:"input-group",children:[e.jsx("label",{className:"input-label",children:"Album"}),e.jsx("input",{type:"text",name:"album",value:u.album,onChange:f,className:"input",placeholder:"Nom de l'album"})]}),e.jsxs("div",{className:"input-group",children:[e.jsx("label",{className:"input-label",children:"Genre"}),e.jsxs("select",{name:"genre",value:u.genre,onChange:f,className:"input",children:[e.jsx("option",{value:"",children:"Sélectionner un genre"}),e.jsx("option",{value:"pop",children:"Pop"}),e.jsx("option",{value:"rock",children:"Rock"}),e.jsx("option",{value:"hiphop",children:"Hip-Hop"}),e.jsx("option",{value:"electronic",children:"Électronique"}),e.jsx("option",{value:"jazz",children:"Jazz"}),e.jsx("option",{value:"classical",children:"Classique"}),e.jsx("option",{value:"rnb",children:"R&B"}),e.jsx("option",{value:"metal",children:"Metal"}),e.jsx("option",{value:"indie",children:"Indie"}),e.jsx("option",{value:"folk",children:"Folk"}),e.jsx("option",{value:"reggae",children:"Reggae"}),e.jsx("option",{value:"country",children:"Country"}),e.jsx("option",{value:"other",children:"Autre"})]})]})]}),e.jsxs("div",{className:"input-group",children:[e.jsx("label",{className:"input-label",children:"Description"}),e.jsx("textarea",{name:"description",value:u.description,onChange:f,className:"input textarea",placeholder:"Parlez-nous de cette piste... (optionnel)",rows:4})]}),x&&e.jsxs("div",{className:"upload-progress",children:[e.jsxs("div",{className:"progress-info",children:[e.jsx(ns,{className:"progress-icon",size:20}),e.jsx("span",{children:"Upload en cours..."}),e.jsxs("span",{className:"progress-percent",children:[g,"%"]})]}),e.jsx("div",{className:"progress-bar-container",children:e.jsx("div",{className:"progress-bar-fill",style:{width:`${g}%`}})})]}),e.jsx("button",{type:"submit",className:"btn btn-primary btn-lg upload-submit",disabled:x||!v,children:x?e.jsxs(e.Fragment,{children:[e.jsx(ls,{className:"spinner-icon animate-spin",size:22}),"Upload en cours..."]}):e.jsxs(e.Fragment,{children:[e.jsx(K,{size:22}),"Publier la piste"]})})]})]})})]})})}const Es=[{id:101,title:"Ma Première Création",artist:"Moi",coverUrl:"https://picsum.photos/seed/mytrack1/300/300",duration:234},{id:102,title:"Souvenirs d'Été",artist:"Moi",coverUrl:"https://picsum.photos/seed/mytrack2/300/300",duration:198},{id:103,title:"Nuit Sans Fin",artist:"Moi",coverUrl:"https://picsum.photos/seed/mytrack3/300/300",duration:267}],Rs=[{id:1,title:"Nuit Étoilée",artist:"Luna Wave",coverUrl:"https://picsum.photos/seed/track1/300/300",duration:234},{id:2,title:"Horizon Lointain",artist:"Solar Beats",coverUrl:"https://picsum.photos/seed/track2/300/300",duration:198}];function Ts(){const s=J(),{user:l,token:r,isAuthenticated:d}=D(),[t,m]=a.useState("uploads"),[u,p]=a.useState("grid"),[v,k]=a.useState(""),[b,h]=a.useState(Es),[n,N]=a.useState(Rs),[x,y]=a.useState(!1);a.useEffect(()=>{d&&r&&g()},[d,r]);const g=async()=>{var j,z;y(!0);try{const[M,C]=await Promise.all([fetch("/api/tracks/my-uploads",{headers:{Authorization:`Bearer ${r}`}}),fetch("/api/tracks/liked",{headers:{Authorization:`Bearer ${r}`}})]);if(M.ok){const A=await M.json();((j=A.tracks)==null?void 0:j.length)>0&&h(A.tracks)}if(C.ok){const A=await C.json();((z=A.tracks)==null?void 0:z.length)>0&&N(A.tracks)}}catch(M){console.error("Erreur chargement bibliothèque:",M)}finally{y(!1)}};if(!d)return e.jsx("div",{className:"page",children:e.jsx("div",{className:"container",children:e.jsxs("div",{className:"library-auth-required glass",children:[e.jsx(X,{size:48}),e.jsx("h2",{children:"Connexion requise"}),e.jsx("p",{children:"Connectez-vous pour accéder à votre bibliothèque musicale."}),e.jsx("button",{onClick:()=>s("/login"),className:"btn btn-primary",children:"Se connecter"})]})})});const c=(t==="uploads"?b:n).filter(j=>j.title.toLowerCase().includes(v.toLowerCase())||j.artist.toLowerCase().includes(v.toLowerCase()));return e.jsx("div",{className:"page library-page",children:e.jsxs("div",{className:"container",children:[e.jsxs("div",{className:"library-header",children:[e.jsx("div",{className:"header-left",children:e.jsxs("h1",{className:"page-title",children:[e.jsx(ce,{}),"Ma Bibliothèque"]})}),e.jsxs("div",{className:"header-right",children:[e.jsxs("div",{className:"search-box",children:[e.jsx(ee,{size:18}),e.jsx("input",{type:"text",placeholder:"Rechercher...",value:v,onChange:j=>k(j.target.value)})]}),e.jsxs("div",{className:"view-toggle",children:[e.jsx("button",{className:`toggle-btn ${u==="grid"?"active":""}`,onClick:()=>p("grid"),children:e.jsx(cs,{size:18})}),e.jsx("button",{className:`toggle-btn ${u==="list"?"active":""}`,onClick:()=>p("list"),children:e.jsx(os,{size:18})})]})]})]}),e.jsxs("div",{className:"library-tabs",children:[e.jsxs("button",{className:`tab-btn ${t==="uploads"?"active":""}`,onClick:()=>m("uploads"),children:[e.jsx($,{size:18}),"Mes Uploads",e.jsx("span",{className:"tab-count",children:b.length})]}),e.jsxs("button",{className:`tab-btn ${t==="liked"?"active":""}`,onClick:()=>m("liked"),children:[e.jsx(O,{size:18}),"Favoris",e.jsx("span",{className:"tab-count",children:n.length})]}),e.jsxs("button",{className:`tab-btn ${t==="recent"?"active":""}`,onClick:()=>m("recent"),children:[e.jsx(Pe,{size:18}),"Récents"]})]}),x?e.jsx("div",{className:"loading",children:e.jsx("div",{className:"spinner"})}):c.length===0?e.jsxs("div",{className:"empty-state",children:[e.jsx("div",{className:"empty-state-icon",children:t==="uploads"?e.jsx($,{}):e.jsx(O,{})}),e.jsx("h3",{className:"empty-state-title",children:t==="uploads"?"Aucun upload pour le moment":"Aucun favori pour le moment"}),e.jsx("p",{className:"empty-state-text",children:t==="uploads"?"Commencez à partager votre musique avec la communauté":"Ajoutez des titres à vos favoris pour les retrouver ici"}),t==="uploads"&&e.jsxs(P,{to:"/upload",className:"btn btn-primary",children:[e.jsx(oe,{size:18}),"Uploader ma première piste"]})]}):e.jsx("div",{className:u==="grid"?"grid grid-4":"track-list",children:c.map((j,z)=>e.jsx("div",{className:"animate-fadeIn",style:{animationDelay:`${z*.05}s`},children:e.jsx(G,{track:j,tracks:c,variant:u==="list"?"list":"default"})},j.id))}),t==="uploads"&&c.length>0&&e.jsx("div",{className:"library-cta",children:e.jsxs(P,{to:"/upload",className:"btn btn-secondary",children:[e.jsx(oe,{size:18}),"Ajouter une piste"]})})]})})}const Is={uploads:12,likes:45,plays:1234},Ds=[{id:101,title:"Ma Première Création",artist:"Moi",coverUrl:"https://picsum.photos/seed/mytrack1/300/300",duration:234},{id:102,title:"Souvenirs d'Été",artist:"Moi",coverUrl:"https://picsum.photos/seed/mytrack2/300/300",duration:198},{id:103,title:"Nuit Sans Fin",artist:"Moi",coverUrl:"https://picsum.photos/seed/mytrack3/300/300",duration:267}];function ze(){var o;const s=J(),{user:l,token:r,isAuthenticated:d,logout:t}=D(),[m,u]=a.useState(!1),[p,v]=a.useState(Is),[k,b]=a.useState(Ds),[h,n]=a.useState({username:"",bio:""}),[N,x]=a.useState(!1);a.useEffect(()=>{l&&n({username:l.username||"",bio:l.bio||""})},[l]),a.useEffect(()=>{d&&r&&y()},[d,r]);const y=async()=>{var c;try{const j=await fetch("/api/users/profile",{headers:{Authorization:`Bearer ${r}`}});if(j.ok){const z=await j.json();z.stats&&v(z.stats),((c=z.tracks)==null?void 0:c.length)>0&&b(z.tracks)}}catch(j){console.error("Erreur chargement profil:",j)}},g=async()=>{x(!0);try{(await fetch("/api/users/profile",{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${r}`},body:JSON.stringify(h)})).ok&&u(!1)}catch(c){console.error("Erreur sauvegarde profil:",c)}finally{x(!1)}};return d?e.jsx("div",{className:"page profile-page",children:e.jsxs("div",{className:"container",children:[e.jsxs("div",{className:"profile-header glass",children:[e.jsx("div",{className:"profile-cover",children:e.jsx("div",{className:"cover-gradient"})}),e.jsxs("div",{className:"profile-main",children:[e.jsxs("div",{className:"profile-avatar-section",children:[e.jsx("div",{className:"avatar-xl profile-avatar",children:(o=l==null?void 0:l.username)==null?void 0:o.charAt(0).toUpperCase()}),e.jsx("button",{className:"avatar-edit-btn",children:e.jsx(ds,{size:16})})]}),e.jsx("div",{className:"profile-info",children:m?e.jsxs("div",{className:"profile-edit-form",children:[e.jsx("input",{type:"text",value:h.username,onChange:c=>n({...h,username:c.target.value}),className:"input profile-name-input",placeholder:"Nom d'utilisateur"}),e.jsx("textarea",{value:h.bio,onChange:c=>n({...h,bio:c.target.value}),className:"input profile-bio-input",placeholder:"Votre bio...",rows:2}),e.jsxs("div",{className:"edit-actions",children:[e.jsxs("button",{onClick:g,className:"btn btn-primary btn-sm",disabled:N,children:[e.jsx(us,{size:16}),"Sauvegarder"]}),e.jsxs("button",{onClick:()=>u(!1),className:"btn btn-ghost btn-sm",children:[e.jsx(B,{size:16}),"Annuler"]})]})]}):e.jsxs(e.Fragment,{children:[e.jsx("h1",{className:"profile-name",children:l==null?void 0:l.username}),e.jsx("p",{className:"profile-bio",children:(l==null?void 0:l.bio)||"Aucune bio pour le moment"}),e.jsxs("div",{className:"profile-meta",children:[e.jsxs("span",{className:"meta-item",children:[e.jsx(xe,{size:16}),l==null?void 0:l.email]}),e.jsxs("span",{className:"meta-item",children:[e.jsx(ms,{size:16}),"Membre depuis ",new Date((l==null?void 0:l.createdAt)||Date.now()).toLocaleDateString("fr-FR",{month:"long",year:"numeric"})]})]})]})}),e.jsxs("div",{className:"profile-actions",children:[!m&&e.jsxs("button",{onClick:()=>u(!0),className:"btn btn-secondary",children:[e.jsx(hs,{size:18}),"Modifier"]}),e.jsx("button",{className:"btn btn-ghost btn-icon",children:e.jsx(Se,{size:20})})]})]}),e.jsxs("div",{className:"profile-stats",children:[e.jsxs("div",{className:"stat-item",children:[e.jsx("div",{className:"stat-icon",children:e.jsx($,{size:20})}),e.jsxs("div",{className:"stat-content",children:[e.jsx("span",{className:"stat-value",children:p.uploads}),e.jsx("span",{className:"stat-label",children:"Uploads"})]})]}),e.jsxs("div",{className:"stat-item",children:[e.jsx("div",{className:"stat-icon",children:e.jsx(O,{size:20})}),e.jsxs("div",{className:"stat-content",children:[e.jsx("span",{className:"stat-value",children:p.likes}),e.jsx("span",{className:"stat-label",children:"Likes reçus"})]})]}),e.jsxs("div",{className:"stat-item",children:[e.jsx("div",{className:"stat-icon",children:e.jsx(H,{size:20})}),e.jsxs("div",{className:"stat-content",children:[e.jsx("span",{className:"stat-value",children:p.plays.toLocaleString()}),e.jsx("span",{className:"stat-label",children:"Écoutes"})]})]})]})]}),e.jsxs("section",{className:"section",children:[e.jsx("div",{className:"section-header",children:e.jsxs("h2",{className:"section-title",children:[e.jsx($,{}),"Mes pistes"]})}),k.length===0?e.jsxs("div",{className:"empty-state",children:[e.jsx("div",{className:"empty-state-icon",children:e.jsx($,{})}),e.jsx("h3",{className:"empty-state-title",children:"Aucune piste uploadée"}),e.jsx("p",{className:"empty-state-text",children:"Commencez à partager votre musique !"}),e.jsx("button",{onClick:()=>s("/upload"),className:"btn btn-primary",children:"Uploader une piste"})]}):e.jsx("div",{className:"grid grid-4",children:k.map((c,j)=>e.jsx("div",{className:"animate-fadeIn",style:{animationDelay:`${j*.1}s`},children:e.jsx(G,{track:c,tracks:k})},c.id))})]}),e.jsxs("section",{className:"danger-zone glass",children:[e.jsx("h3",{children:"Zone de danger"}),e.jsx("p",{children:"Actions irréversibles sur votre compte"}),e.jsxs("div",{className:"danger-actions",children:[e.jsx("button",{onClick:t,className:"btn btn-ghost danger-btn",children:"Se déconnecter"}),e.jsx("button",{className:"btn btn-ghost danger-btn",children:"Supprimer mon compte"})]})]})]})}):e.jsx("div",{className:"page",children:e.jsx("div",{className:"container",children:e.jsxs("div",{className:"profile-auth-required glass",children:[e.jsx(X,{size:48}),e.jsx("h2",{children:"Connexion requise"}),e.jsx("p",{children:"Connectez-vous pour accéder à votre profil."}),e.jsx("button",{onClick:()=>s("/login"),className:"btn btn-primary",children:"Se connecter"})]})})})}const Fs=[{id:"all",name:"Tous les genres"},{id:"pop",name:"Pop"},{id:"rock",name:"Rock"},{id:"hiphop",name:"Hip-Hop"},{id:"electronic",name:"Électronique"},{id:"jazz",name:"Jazz"},{id:"classical",name:"Classique"},{id:"rnb",name:"R&B"},{id:"metal",name:"Metal"},{id:"indie",name:"Indie"}],Bs=[{id:"trending",name:"Tendances",icon:de},{id:"new",name:"Nouveautés",icon:_},{id:"popular",name:"Populaires",icon:$}],Os=[{id:1,title:"Nuit Étoilée",artist:"Luna Wave",genre:"electronic",coverUrl:"https://picsum.photos/seed/track1/300/300",duration:234},{id:2,title:"Horizon Lointain",artist:"Solar Beats",genre:"pop",coverUrl:"https://picsum.photos/seed/track2/300/300",duration:198},{id:3,title:"Rêves Électriques",artist:"Neon Dreams",genre:"electronic",coverUrl:"https://picsum.photos/seed/track3/300/300",duration:267},{id:4,title:"Voyage Nocturne",artist:"Midnight Sun",genre:"jazz",coverUrl:"https://picsum.photos/seed/track4/300/300",duration:312},{id:5,title:"Éclat de Lune",artist:"Aurora",genre:"indie",coverUrl:"https://picsum.photos/seed/track5/300/300",duration:245},{id:6,title:"Cascade Sonore",artist:"Flow State",genre:"electronic",coverUrl:"https://picsum.photos/seed/track6/300/300",duration:289},{id:7,title:"Aurore Boréale",artist:"Nordic Pulse",genre:"classical",coverUrl:"https://picsum.photos/seed/track7/300/300",duration:201},{id:8,title:"Tempête de Feu",artist:"Blaze",genre:"rock",coverUrl:"https://picsum.photos/seed/track8/300/300",duration:276},{id:9,title:"Mélodie du Soir",artist:"Twilight",genre:"pop",coverUrl:"https://picsum.photos/seed/track9/300/300",duration:223},{id:10,title:"Battement de Coeur",artist:"Pulse",genre:"rnb",coverUrl:"https://picsum.photos/seed/track10/300/300",duration:256},{id:11,title:"Onde de Choc",artist:"Impact",genre:"hiphop",coverUrl:"https://picsum.photos/seed/track11/300/300",duration:189},{id:12,title:"Symphonie Urbaine",artist:"City Lights",genre:"jazz",coverUrl:"https://picsum.photos/seed/track12/300/300",duration:301}];function Hs(){const[s,l]=Te(),[r,d]=a.useState(s.get("q")||""),[t,m]=a.useState("all"),[u,p]=a.useState(s.get("sort")||"trending"),[v,k]=a.useState(!1),[b,h]=a.useState(Os),[n,N]=a.useState(!1);a.useEffect(()=>{x()},[t,u,r]);const x=async()=>{var o;N(!0);try{const c=new URLSearchParams;r&&c.set("q",r),t!=="all"&&c.set("genre",t),c.set("sort",u);const j=await fetch(`/api/tracks/search?${c}`);if(j.ok){const z=await j.json();((o=z.tracks)==null?void 0:o.length)>0&&h(z.tracks)}}catch{}finally{N(!1)}},y=o=>{o.preventDefault();const c=new URLSearchParams(s);r?c.set("q",r):c.delete("q"),l(c)},g=b.filter(o=>{const c=!r||o.title.toLowerCase().includes(r.toLowerCase())||o.artist.toLowerCase().includes(r.toLowerCase()),j=t==="all"||o.genre===t;return c&&j});return e.jsx("div",{className:"page explore-page",children:e.jsxs("div",{className:"container",children:[e.jsxs("div",{className:"explore-header",children:[e.jsxs("form",{onSubmit:y,className:"explore-search",children:[e.jsx(ee,{size:22}),e.jsx("input",{type:"text",placeholder:"Rechercher des artistes, titres, albums...",value:r,onChange:o=>d(o.target.value)}),r&&e.jsx("button",{type:"button",className:"clear-search",onClick:()=>d(""),children:e.jsx(B,{size:18})})]}),e.jsxs("button",{className:`btn btn-secondary filter-toggle ${v?"active":""}`,onClick:()=>k(!v),children:[e.jsx(xs,{size:18}),"Filtres",e.jsx(se,{size:16,className:v?"rotated":""})]})]}),v&&e.jsx("div",{className:"explore-filters animate-fadeIn",children:e.jsxs("div",{className:"filter-section",children:[e.jsx("label",{className:"filter-label",children:"Genre"}),e.jsx("div",{className:"filter-options",children:Fs.map(o=>e.jsx("button",{className:`filter-chip ${t===o.id?"active":""}`,onClick:()=>m(o.id),children:o.name},o.id))})]})}),e.jsx("div",{className:"explore-sort",children:Bs.map(o=>{const c=o.icon;return e.jsxs("button",{className:`sort-btn ${u===o.id?"active":""}`,onClick:()=>p(o.id),children:[e.jsx(c,{size:18}),o.name]},o.id)})}),r&&e.jsxs("p",{className:"search-results-info",children:[g.length," résultat",g.length>1?"s":"",' pour "',r,'"']}),n?e.jsx("div",{className:"loading",children:e.jsx("div",{className:"spinner"})}):g.length===0?e.jsxs("div",{className:"empty-state",children:[e.jsx("div",{className:"empty-state-icon",children:e.jsx(ee,{})}),e.jsx("h3",{className:"empty-state-title",children:"Aucun résultat"}),e.jsx("p",{className:"empty-state-text",children:"Essayez avec d'autres termes ou modifiez vos filtres"})]}):e.jsx("div",{className:"grid grid-4",children:g.map((o,c)=>e.jsx("div",{className:"animate-fadeIn",style:{animationDelay:`${c*.05}s`},children:e.jsx(G,{track:o,tracks:g})},o.id))})]})})}function Vs(){return e.jsx(bs,{children:e.jsx(ys,{children:e.jsx(Cs,{children:e.jsx(Ie,{children:e.jsxs("div",{className:"app",children:[e.jsx(Ss,{}),e.jsx("main",{className:"main-content",children:e.jsxs(De,{children:[e.jsx(I,{path:"/",element:e.jsx($s,{})}),e.jsx(I,{path:"/login",element:e.jsx(As,{})}),e.jsx(I,{path:"/register",element:e.jsx(qs,{})}),e.jsx(I,{path:"/upload",element:e.jsx(Ls,{})}),e.jsx(I,{path:"/library",element:e.jsx(Ts,{})}),e.jsx(I,{path:"/profile",element:e.jsx(ze,{})}),e.jsx(I,{path:"/profile/:id",element:e.jsx(ze,{})}),e.jsx(I,{path:"/explore",element:e.jsx(Hs,{})})]})}),e.jsx(ws,{})]})})})})})}me.createRoot(document.getElementById("root")).render(e.jsx(Fe.StrictMode,{children:e.jsx(Vs,{})}));
